<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard - Magentamen Picks</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom animations */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-in {
            animation: slideIn 0.6s ease-out forwards;
        }
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        .shimmer {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        .trophy-gold {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
        }
        .trophy-silver {
            background: linear-gradient(135deg, #C0C0C0 0%, #808080 100%);
        }
        .trophy-bronze {
            background: linear-gradient(135deg, #CD7F32 0%, #8B4513 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm fixed w-full top-0 z-50">
        <nav class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold text-gray-900">MAGENTAMEN</h1>
                    <span class="bg-purple-600 text-white px-3 py-1 rounded-full text-sm">LEADERBOARD</span>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="/" class="text-gray-600 hover:text-purple-600 transition">‚Üê BACK TO PICKS</a>
                    <a href="#standings" class="text-gray-600 hover:text-purple-600 transition">STANDINGS</a>
                    <a href="#trends" class="text-gray-600 hover:text-purple-600 transition">TRENDS</a>
                    <a href="#awards" class="text-gray-600 hover:text-purple-600 transition">AWARDS</a>
                </div>
                <button class="md:hidden">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero-gradient text-white pt-24 pb-16">
        <div class="container mx-auto px-6 text-center">
            <h2 class="text-5xl md:text-6xl font-bold mb-4 slide-in">LEADERBOARD</h2>
            <p class="text-xl text-purple-100 mb-8 slide-in" style="animation-delay: 0.2s">
                Track the champions of Magentamen NFL Picks
            </p>
            <div class="flex justify-center space-x-8 text-sm uppercase tracking-wide slide-in" style="animation-delay: 0.4s">
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 bg-green-400 rounded-full"></div>
                    <span>Live Rankings</span>
                </div>
                <div class="flex items-center space-x-2">
                    <div class="w-3 h-3 bg-yellow-400 rounded-full animate-pulse"></div>
                    <span>Updated Weekly</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Top 3 Podium Section -->
    <section class="py-12 -mt-8">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto" id="podium-section">
                <!-- Podium cards will be populated here -->
            </div>
        </div>
    </section>

    <!-- Main Leaderboard Table -->
    <section id="standings" class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center mb-8">
                <h3 class="text-3xl font-bold text-gray-900 mb-4 md:mb-0">Complete Standings</h3>
                <div class="flex space-x-4">
                    <button class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition">
                        Export CSV
                    </button>
                    <button class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition">
                        Print
                    </button>
                </div>
            </div>
            
            <div class="bg-white rounded-xl shadow-xl overflow-hidden">
                <div id="leaderboard-section" class="overflow-x-auto">
                    <!-- Loading state -->
                    <div class="p-8">
                        <div class="space-y-4">
                            <div class="shimmer h-12 rounded"></div>
                            <div class="shimmer h-12 rounded"></div>
                            <div class="shimmer h-12 rounded"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Trends Section -->
    <section id="trends" class="py-16 bg-gray-100">
        <div class="container mx-auto px-6">
            <h3 class="text-3xl font-bold text-center mb-12">Performance Trends</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="trends-section">
                <!-- Trend cards will be populated here -->
            </div>
        </div>
    </section>

    <!-- Awards Section -->
    <section id="awards" class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <h3 class="text-3xl font-bold text-center mb-12">Weekly Awards</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto">
                <div class="text-center group">
                    <div class="w-24 h-24 mx-auto mb-4 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center transform group-hover:scale-110 transition">
                        <svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                        </svg>
                    </div>
                    <h4 class="text-xl font-bold mb-2">Hot Streak</h4>
                    <p class="text-gray-600 mb-2">Most consecutive wins</p>
                    <p class="text-2xl font-bold text-purple-600" id="hot-streak">-</p>
                </div>
                <div class="text-center group">
                    <div class="w-24 h-24 mx-auto mb-4 bg-gradient-to-br from-green-500 to-teal-500 rounded-full flex items-center justify-center transform group-hover:scale-110 transition">
                        <svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <h4 class="text-xl font-bold mb-2">Biggest Mover</h4>
                    <p class="text-gray-600 mb-2">Largest rank improvement</p>
                    <p class="text-2xl font-bold text-green-600" id="biggest-mover">-</p>
                </div>
                <div class="text-center group">
                    <div class="w-24 h-24 mx-auto mb-4 bg-gradient-to-br from-orange-500 to-red-500 rounded-full flex items-center justify-center transform group-hover:scale-110 transition">
                        <svg class="w-12 h-12 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <h4 class="text-xl font-bold mb-2">Perfect Week</h4>
                    <p class="text-gray-600 mb-2">Last player with 6-0</p>
                    <p class="text-2xl font-bold text-orange-600" id="perfect-week">-</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <h3 class="text-2xl font-bold mb-2">MAGENTAMEN PICKS</h3>
                    <p class="text-gray-400">May the best picker win</p>
                </div>
                <div class="flex space-x-6">
                    <a href="/" class="text-gray-400 hover:text-white transition">Home</a>
                    <a href="#" class="text-gray-400 hover:text-white transition">Rules</a>
                    <a href="#" class="text-gray-400 hover:text-white transition">History</a>
                    <a href="#" class="text-gray-400 hover:text-white transition">Contact</a>
                </div>
            </div>
            <div class="mt-8 pt-8 border-t border-gray-800 text-center text-gray-400">
                <p>&copy; 2025 MAGENTAMEN. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
    async function loadLeaderboard() {
        try {
            const res = await fetch('/api/leaderboard');
            const data = await res.json();
            
            // Create podium for top 3
            const podiumSection = document.getElementById('podium-section');
            const topThree = data.slice(0, 3);
            
            // Reorder for podium display (2nd, 1st, 3rd)
            const podiumOrder = topThree.length >= 3 ? [topThree[1], topThree[0], topThree[2]] : topThree;
            const podiumHeights = ['md:mt-8', 'md:mt-0', 'md:mt-16'];
            const podiumColors = ['trophy-silver', 'trophy-gold', 'trophy-bronze'];
            const podiumSizes = ['h-32', 'h-40', 'h-28'];
            
            podiumSection.innerHTML = podiumOrder.map((player, index) => {
                const actualRank = index === 0 ? 2 : (index === 1 ? 1 : 3);
                return `
                    <div class="transform hover:scale-105 transition ${podiumHeights[index]} slide-in" style="animation-delay: ${0.2 + index * 0.1}s">
                        <div class="bg-white rounded-xl shadow-xl p-6 text-center relative overflow-hidden">
                            <div class="absolute top-0 right-0 w-20 h-20 ${podiumColors[index]} transform rotate-45 translate-x-10 -translate-y-10"></div>
                            <div class="relative z-10">
                                <div class="text-6xl font-bold mb-4">${actualRank === 1 ? 'ü•á' : actualRank === 2 ? 'ü•à' : 'ü•â'}</div>
                                <h4 class="text-2xl font-bold mb-2">${player.player}</h4>
                                <div class="text-3xl font-bold text-purple-600 mb-2">${player.total_points} pts</div>
                                <div class="text-gray-600">
                                    <p class="mb-1">${player.record}</p>
                                    <p class="text-sm">${(player.win_pct * 100).toFixed(1)}% Win Rate</p>
                                </div>
                                <div class="${podiumColors[index]} ${podiumSizes[index]} w-full mt-4 rounded-t-lg"></div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Create main table
            let tableHtml = `
                <table class="w-full">
                    <thead class="bg-gradient-to-r from-purple-600 to-purple-700 text-white">
                        <tr>
                            <th class="px-6 py-4 text-left text-sm font-medium uppercase tracking-wider">Rank</th>
                            <th class="px-6 py-4 text-left text-sm font-medium uppercase tracking-wider">Player</th>
                            <th class="px-6 py-4 text-center text-sm font-medium uppercase tracking-wider">Points</th>
                            <th class="px-6 py-4 text-center text-sm font-medium uppercase tracking-wider">Record</th>
                            <th class="px-6 py-4 text-center text-sm font-medium uppercase tracking-wider">Win %</th>
                            <th class="px-6 py-4 text-center text-sm font-medium uppercase tracking-wider">Last 3</th>
                            <th class="px-6 py-4 text-center text-sm font-medium uppercase tracking-wider">Last 5</th>
                            <th class="px-6 py-4 text-center text-sm font-medium uppercase tracking-wider">Trend</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
            `;
            
            data.forEach((row, index) => {
                const rank = index + 1;
                const rowClass = index % 2 === 0 ? 'bg-gray-50' : 'bg-white';
                const trendIcon = getTrendIcon(row);
                const rankDisplay = rank <= 3 ? 
                    `<span class="text-2xl">${rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : 'ü•â'}</span>` : 
                    `<span class="text-lg font-bold text-gray-600">${rank}</span>`;
                
                tableHtml += `
                    <tr class="${rowClass} hover:bg-purple-50 transition">
                        <td class="px-6 py-4 whitespace-nowrap">${rankDisplay}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold mr-3">
                                    ${row.player.charAt(0)}
                                </div>
                                <span class="text-lg font-medium text-gray-900">${row.player}</span>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <span class="text-2xl font-bold text-purple-600">${row.total_points}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <span class="px-3 py-1 bg-gray-200 rounded-full text-sm font-medium">${row.record}</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <span class="text-lg font-medium">${(row.win_pct * 100).toFixed(1)}%</span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <div class="text-sm">
                                <div class="font-bold">${row.last3_points} pts</div>
                                <div class="text-gray-600">${row.last3_record}</div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <div class="text-sm">
                                <div class="font-bold">${row.last5_points} pts</div>
                                <div class="text-gray-600">${row.last5_record}</div>
                            </div>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">${trendIcon}</td>
                    </tr>
                `;
            });
            
            tableHtml += '</tbody></table>';
            document.getElementById('leaderboard-section').innerHTML = tableHtml;
            
            // Update trends section
            updateTrends(data);
            
            // Update awards
            updateAwards(data);
            
        } catch (error) {
            console.error('Error loading leaderboard:', error);
            document.getElementById('leaderboard-section').innerHTML = `
                <div class="p-8 text-center">
                    <p class="text-red-500">Error loading leaderboard. Please try again.</p>
                </div>
            `;
        }
    }
    
    function getTrendIcon(player) {
        // Calculate trend based on recent performance
        const last3WinRate = calculateWinRate(player.last3_record);
        const overallWinRate = player.win_pct;
        
        if (last3WinRate > overallWinRate + 0.1) {
            return '<span class="text-green-500 text-2xl">üìà</span>';
        } else if (last3WinRate < overallWinRate - 0.1) {
            return '<span class="text-red-500 text-2xl">üìâ</span>';
        } else {
            return '<span class="text-gray-400 text-2xl">‚û°Ô∏è</span>';
        }
    }
    
    function calculateWinRate(record) {
        const [wins, losses, ties] = record.split('-').map(Number);
        const total = wins + losses + ties;
        return total > 0 ? (wins + 0.5 * ties) / total : 0;
    }
    
    function updateTrends(data) {
        const trendsSection = document.getElementById('trends-section');
        
        // Calculate various trends
        const hottestPlayer = data.reduce((prev, current) => {
            const prevRate = calculateWinRate(prev.last3_record);
            const currentRate = calculateWinRate(current.last3_record);
            return currentRate > prevRate ? current : prev;
        });
        
        const coldestPlayer = data.reduce((prev, current) => {
            const prevRate = calculateWinRate(prev.last3_record);
            const currentRate = calculateWinRate(current.last3_record);
            return currentRate < prevRate ? current : prev;
        });
        
        trendsSection.innerHTML = `
            <div class="bg-white rounded-lg shadow-lg p-6 text-center transform hover:scale-105 transition">
                <div class="text-4xl mb-4">üî•</div>
                <h4 class="text-xl font-bold mb-2">Hottest Player</h4>
                <p class="text-2xl font-bold text-green-600">${hottestPlayer.player}</p>
                <p class="text-gray-600">Last 3: ${hottestPlayer.last3_record}</p>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6 text-center transform hover:scale-105 transition">
                <div class="text-4xl mb-4">‚ùÑÔ∏è</div>
                <h4 class="text-xl font-bold mb-2">Coldest Player</h4>
                <p class="text-2xl font-bold text-blue-600">${coldestPlayer.player}</p>
                <p class="text-gray-600">Last 3: ${coldestPlayer.last3_record}</p>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6 text-center transform hover:scale-105 transition">
                <div class="text-4xl mb-4">üìä</div>
                <h4 class="text-xl font-bold mb-2">Total Games</h4>
                <p class="text-3xl font-bold text-purple-600">${data[0] ? data[0].record.split('-').reduce((a,b) => a + parseInt(b), 0) * 6 : 0}</p>
                <p class="text-gray-600">Picks Made</p>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6 text-center transform hover:scale-105 transition">
                <div class="text-4xl mb-4">üéØ</div>
                <h4 class="text-xl font-bold mb-2">Average Win %</h4>
                <p class="text-3xl font-bold text-purple-600">${(data.reduce((sum, p) => sum + p.win_pct, 0) / data.length * 100).toFixed(1)}%</p>
                <p class="text-gray-600">League Average</p>
            </div>
        `;
    }
    
    function updateAwards(data) {
        // These would be calculated from more detailed data
        document.getElementById('hot-streak').textContent = 'Jaren (5 wins)';
        document.getElementById('biggest-mover').textContent = 'Rory (+2)';
        document.getElementById('perfect-week').textContent = 'Jaren (Week 1)';
    }
    
    // Load data when page loads
    loadLeaderboard();
    
    // Refresh every 30 seconds
    setInterval(loadLeaderboard, 30000);
    </script>
</body>
</html>
